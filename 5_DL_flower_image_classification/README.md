# Flower Image Classification Project  
## EfficientNetB0 기반 꽃 이미지 분류 모델

EfficientNetB0를 활용해 5종의 꽃 이미지를 분류하는 딥러닝 모델을 만든 프로젝트입니다.  
여러 모델을 직접 실험하면서, **모델 구조 자체보다 전처리 파이프라인과 학습 흐름이 성능에 얼마나 큰 영향을 주는지**를 확인하는 데 의미가 있었던 작업입니다.

---

## 1. 프로젝트 개요

**목적**  
- Daisy, Dandelion, Roses, Sunflowers, Tulips 총 5종의 꽃 이미지를 분류하는 이미지 분류 모델 구축

**주요 결과**  
- 최종 테스트 정확도 **92.64%** 달성  
- VGG 기반 모델 대비 성능 유의미하게 개선

**사용 기술**  
- TensorFlow, Keras, EfficientNetB0, Python

---

## 2. 모델 아키텍처 및 학습 전략

본 프로젝트에서는 ImageNet으로 사전 학습된 **EfficientNetB0**를 기반으로 전이 학습을 적용했습니다.

### 모델 구조

- **Base Model**
  - ImageNet pretrained EfficientNetB0 사용
  - 초기 학습 단계에서는 전체 가중치를 고정(freeze)

- **GlobalAveragePooling2D**
  - convolution feature map을 1차원 벡터로 변환
  - Dense layer 사용 대비 파라미터 수를 줄이고 과적합을 완화

- **Dropout (0.5)**
  - 분류기 부분에서 과적합을 방지하기 위해 적용

- **Output Layer**
  - Softmax 활성화 함수를 사용한 5개 클래스 분류

---

## 3. 데이터 전처리 및 파이프라인 이슈

### 입력 이미지 크기

- 입력 해상도: **160 × 160**
- EfficientNetB0 기본 구조에 맞춰 resize 적용

### 전처리 파이프라인 문제 해결

EfficientNetB0를 적용한 초반 실험에서,  
모델 구조 대비 성능 향상이 거의 나타나지 않는 문제가 발생했습니다.

원인을 분석한 결과:

- EfficientNet 내부에는 이미 **Rescaling을 포함한 preprocessing 로직**이 존재
- 기존에 사용하던 `-1 ~ 1` 정규화 방식과 충돌 발생

이에 따라,

- 입력 이미지를 **0 ~ 255 범위의 원본 픽셀 값 그대로 전달**
- 불필요한 수동 정규화를 제거하여 전처리 파이프라인을 단순화

이 과정을 통해 학습 안정성과 성능이 함께 개선되는 것을 확인했습니다.

---

## 4. 학습 과정 및 결과

- **VGG 기반 모델 실험**
  - 초기 VGG 계열 모델에서는 약 **84% 수준**의 정확도에 머무름

- **EfficientNetB0 적용 후**
  - 동일 데이터셋 기준 **92% 이상의 정확도** 달성
  - 모델 변경뿐 아니라 전처리 파이프라인 정리가 성능 개선에 핵심적으로 작용

| 지표 | 결과 |
|---|---|
| 최종 테스트 정확도 | 92.64% |
| 최종 테스트 손실 | 0.2195 |

---

## 5. 추가 실험 및 향후 개선 방향

- **Fine-tuning 실험**
  - 상위 convolution layer 일부를 unfreeze하여 미세 조정 시도
  - 낮은 learning rate로 재학습하며 성능 변화를 관찰

- **향후 개선 아이디어**
  - Data Augmentation 전략 정교화
  - Grad-CAM을 활용한 예측 근거 시각화

---

## 회고

이번 프로젝트에서는 모델을 바꾸는 것보다,  
**데이터가 어떤 형태로 모델에 들어가고 있는지를 정확히 이해하는 것이 더 중요하다는 점**을 배웠습니다.

EfficientNet의 내부 전처리 구조를 제대로 인지하지 못한 상태에서 실험을 진행했던 것이 초기 성능 정체의 원인이었고,  
전처리 파이프라인을 정리한 이후에야 모델의 성능을 제대로 끌어올릴 수 있었습니다.

단순히 복잡한 기법을 추가하기보다는,  
실제 서비스 환경에서도 재현 가능하고 설명 가능한 학습 구조를 만드는 데 초점을 둔 프로젝트였습니다.
(이후 다양한 규제를 적용하여 성능을 올릴 수 있을 것으로 기대됩니다.)
